<h1>Exchange</h1>

<%= form_with model: @item, url: { controller: "items", action: "find" }, method: 'get', local: true do |f| %>
<div>
    <p>Find Items by their Name/Rarity/Type <% f.label :input %><br />
    <%= f.text_field :input, placeholder: "..."%></p>
</div>
<div>
    <%= f.submit "Search Items" %>
</div>
<br>
<% end %>

<h2>User Listed</h2>
<% if @searched_items %>
<h2>Search Results:</h2>
    <% @searched_items.each do |item| %>
        <div class="item-container"><%= link_to item.trader.username, trader_path(item.trader), method: :get %>
            <p>Owner: </p>
            <br>
            <% if item.icon.attached? %>
            <%= cl_image_tag(item.icon.key, crop: :scale, width: 100, cloud_name: ENV["CLOUDINARY_CLOUDNAME"]) %>
            <% end %>
            <p>Name: <%= item.name %></p>
            <p>Type: <%= item.item_type %></p>
            <p>Rarity: <%= item.rarity %></p>
            <p>Description:<%= item.description %></p>
            <p>Power: <%= item.power %></p>
            <p>Price: <%= item.listed_price %></p>
            <button><%= link_to "Buy!", items_buy_path(item), method: "PUT", data: {confirm: "Are you sure?" } %></button>
        </div>
    <% end %>
<% end %>

<h2>Premium</h2>
<% if @exchange_listed %>
<!-- <h2>Premium</h2> -->
    <% @exchange_listed.each do |item| %>
        <div class="item-container">
            <% if item.icon.attached? %>
            <%= cl_image_tag(item.icon.key, crop: :scale, width: 100, cloud_name: ENV["CLOUDINARY_CLOUDNAME"]) %>
            <% end %>
            <p>Name: <%= item.name %></p>
            <p>Type: <%= item.item_type %></p>
            <p>Rarity: <%= item.rarity %></p>
            <p>Description:<%= item.description %></p>
            <p>Power: <%= item.power %></p>
            <p>Price: <%= item.listed_price %></p>
            <button><%= link_to "Buy!", items_buy_path(item), method: "PUT", data: {confirm: "Are you sure?" } %></button>
        </div>
    <% end %>
<% end %>